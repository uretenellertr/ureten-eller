<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Basit Profil Testi</title>
  <style>
    :root{--bg:#0b1220;--ink:#e5e7eb;--brd:#1f2937;--accent:#22d3ee}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .top{display:flex;gap:.5rem;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid var(--brd);position:sticky;top:0;background:var(--bg)}
    a.btn,button.btn{display:inline-block;padding:.6rem .9rem;border:1px solid var(--brd);border-radius:10px;background:#0b1220;color:var(--ink);font-weight:700;text-decoration:none;cursor:pointer}
    a.btn.primary,button.btn.primary{background:linear-gradient(180deg,#16a34a,#065f46);border-color:#0e5135}
    main{padding:16px}
    .block{height:1200px;border:1px dashed var(--brd);border-radius:12px;display:flex;align-items:center;justify-content:center;opacity:.8;margin-bottom:18px}
    #profile{scroll-margin-top:72px} /* üstte sticky bar varsa düzgün hizalansın */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:#0008}
    .card{background:#0c1426;border:1px solid var(--brd);padding:18px;border-radius:12px;max-width:360px}
  </style>
</head>
<body>
  <header class="top">
    <div>🧪 Basit Test</div>
    <!-- SADECE BU: Profil butonu -->
    <a id="btnProfile" class="btn primary" href="#profile">👤 Profil</a>
  </header>

  <main>
    <div class="block">Sayfa içeriği (kaydırma testi için boş alan)</div>

    <!-- Hedef anchor -->
    <h2 id="profile">#profile hedefi</h2>
    <p>Burası profil bölümünün başı. Anchor çalışıyorsa buraya yumuşak kayar.</p>

    <!-- Login durumunu simüle etmek için test butonları -->
    <hr style="border-color:var(--brd);opacity:.4;margin:24px 0">
    <div style="display:flex;gap:.5rem;flex-wrap:wrap">
      <button class="btn" id="setLogin">Simüle: Giriş Yap (localStorage.ue_uid)</button>
      <button class="btn" id="clearLogin">Simüle: Çıkış Yap (ue_uid sil)</button>
      <span id="state" style="margin-left:8px;opacity:.8"></span>
    </div>
  </main>

  <!-- Girişsiz ise açılacak basit modal -->
  <div id="loginModal" class="modal" aria-hidden="true">
    <div class="card">
      <h3 style="margin-top:0">Giriş Gerekli</h3>
      <p>Profil alanını görmek için lütfen giriş yapın.</p>
      <div style="display:flex;gap:.5rem;justify-content:flex-end">
        <button class="btn" id="closeModal">Kapat</button>
      </div>
    </div>
  </div>

  <script>
    // Basit yardımcılar
    const $ = (s) => document.querySelector(s);

    function isLoggedIn(){
      // Gerçek sitede auth’dan geliyor. Biz testte localStorage ile simüle ediyoruz.
      return !!localStorage.getItem('ue_uid');
    }

    // PROFIL BUTONU DAVRANIŞI
    const btn = $('#btnProfile');
    btn.addEventListener('click', (e) => {
      if (!isLoggedIn()){
        // Giriş YOKSA: linki durdurup modal aç
        e.preventDefault();
        openModal();
        return;
      }
      // Giriş VARSA: varsayılan anchor davranışı kalsın (preventDefault YAPMA)
      // (İstersen yumuşak kaydırmayı elle tetikleyebilirsin:)
      // e.preventDefault();
      // document.getElementById('profile').scrollIntoView({ behavior:'smooth', block:'start' });
    });

    // Basit modal aç/kapat
    function openModal(){ const m = $('#loginModal'); m.style.display = 'flex'; m.setAttribute('aria-hidden','false'); }
    function closeModal(){ const m = $('#loginModal'); m.style.display = 'none'; m.setAttribute('aria-hidden','true'); }
    $('#closeModal').addEventListener('click', closeModal);
    $('#loginModal').addEventListener('click', (e)=>{ if(e.target.id==='loginModal') closeModal(); });

    // Test butonları: login state simülasyonu
    $('#setLogin').addEventListener('click', ()=>{
      localStorage.setItem('ue_uid','TEST_UID');
      paintState();
    });
    $('#clearLogin').addEventListener('click', ()=>{
      localStorage.removeItem('ue_uid');
      paintState();
    });

    function paintState(){
      $('#state').textContent = 'Durum: ' + (isLoggedIn() ? 'GİRİŞLİ' : 'GİRİŞSİZ');
    }
    paintState();

    // Hash ile direkt gelme (#profile)
    window.addEventListener('load', ()=>{
      if (location.hash === '#profile'){
        if (!isLoggedIn()){
          openModal();          // girişsizse modal aç
        } // girişliyse zaten anchor çalışıp sayfayı aşağı kaydırır
      }
    });
  </script>
</body>
</html>
