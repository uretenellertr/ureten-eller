(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[322],{9275:function(e,r,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/support",function(){return i(1129)}])},2622:function(e,r,i){"use strict";i.d(r,{Z:function(){return s}});var n=i(5893);i(7294);var t=i(1664),d=i.n(t);function s(e){let{children:r,role:i="owner"}=e;return(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",minHeight:"100vh"},children:[(0,n.jsxs)("aside",{style:{background:"#0b0b0b",color:"#fff",padding:16},children:[(0,n.jsx)("h2",{style:{marginTop:0},children:"Admin"}),(0,n.jsxs)("nav",{style:{display:"grid",gap:8},children:[(0,n.jsx)(d(),{href:"/admin",style:{color:"#e2e8f0"},children:"\xd6n Panel"}),(0,n.jsx)(d(),{href:"/admin/users",style:{color:"#e2e8f0"},children:"Kullanıcılar"}),(0,n.jsx)(d(),{href:"/admin/listings",style:{color:"#e2e8f0"},children:"İlanlar"}),(0,n.jsx)(d(),{href:"/admin/orders",style:{color:"#e2e8f0"},children:"Siparişler"}),(0,n.jsx)(d(),{href:"/admin/support",style:{color:"#e2e8f0"},children:"Canlı Destek"}),(0,n.jsx)(d(),{href:"/admin/moderation",style:{color:"#e2e8f0"},children:"Moderat\xf6r"})]}),(0,n.jsxs)("div",{style:{marginTop:16,fontSize:12,opacity:.8},children:["Rol: ",i]})]}),(0,n.jsx)("section",{style:{padding:16,background:"#f8fafc"},children:r})]})}},2704:function(e,r,i){"use strict";i.d(r,{Z:function(){return l}});var n=i(7294),t=i(6831),d=i(5876),s=i(9828);function l(){let[e,r]=(0,n.useState)(null),[i,l]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=(0,d.onAuthStateChanged)(t.I,async e=>{if(!e){r(null),l(!0);return}try{let i=await (0,s.getDoc)((0,s.doc)(t.db,"roles",e.uid));r(i.exists()?i.data().role:null)}finally{l(!0)}});return()=>e()},[]),{role:e,ready:i}}},6831:function(e,r,i){"use strict";i.d(r,{I:function(){return l},db:function(){return a}});var n=i(3977),t=i(5876),d=i(9828);let s=(0,n.getApps)().length?(0,n.Mq)():(0,n.initializeApp)({apiKey:"AIzaSyCd9GjP6CDA8i4XByhXDHyESy-g_DHVwvQ",authDomain:"ureteneller-ecaac.firebaseapp.com",projectId:"ureteneller-ecaac",storageBucket:"ureteneller-ecaac.firebasestorage.app",messagingSenderId:"368042877151",appId:"1:368042877151:web:ee0879fc4717928079c96a",measurementId:"G-BJHKN8V4RQ"}),l=(0,t.getAuth)(s),a=(0,d.getFirestore)(s)},1129:function(e,r,i){"use strict";i.r(r),i.d(r,{default:function(){return o}});var n=i(5893),t=i(7294),d=i(2622),s=i(2704),l=i(6831),a=i(9828);function o(){let{role:e,ready:r}=(0,s.Z)(),[i,o]=(0,t.useState)([]),[c,u]=(0,t.useState)(null),[f,p]=(0,t.useState)([]),[h,g]=(0,t.useState)("");if((0,t.useEffect)(()=>{(async()=>{o((await (0,a.PL)((0,a.query)((0,a.collection)(l.db,"conversations"),(0,a.where)("status","in",["open","waiting"])))).docs.map(e=>({id:e.id,...e.data()})))})()},[]),(0,t.useEffect)(()=>{if(c)return(0,a.cf)((0,a.query)((0,a.collection)(l.db,"messages"),(0,a.where)("conversationId","==",c.id),(0,a.Xo)("ts","asc")),e=>{p(e.docs.map(e=>({id:e.id,...e.data()})))})},[c]),!r)return null;if(!e)return(0,n.jsx)("div",{style:{padding:24},children:"Yetkiniz yok."});let y=async()=>{let e=l.I.currentUser;e&&c&&h.trim()&&(await (0,a.addDoc)((0,a.collection)(l.db,"messages"),{conversationId:c.id,from:e.uid,text:h.trim(),ts:(0,a.serverTimestamp)()}),g(""),await (0,a.r7)((0,a.doc)(l.db,"conversations",c.id),{status:"open",assignedTo:e.uid}))};return(0,n.jsxs)(d.Z,{role:e,children:[(0,n.jsx)("h1",{children:"Canlı Destek"}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr",gap:12},children:[(0,n.jsx)("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:8},children:i.map(e=>(0,n.jsxs)("div",{onClick:()=>u(e),style:{padding:10,borderRadius:8,cursor:"pointer",background:(null==c?void 0:c.id)===e.id?"#eef2ff":"transparent"},children:[(0,n.jsx)("div",{style:{fontWeight:700},children:e.subject||e.id}),(0,n.jsx)("div",{style:{fontSize:12,color:"#475569"},children:e.status})]},e.id))}),(0,n.jsxs)("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:8,display:"grid",gridTemplateRows:"1fr auto",minHeight:360},children:[(0,n.jsx)("div",{style:{overflow:"auto"},children:f.map(e=>{var r,i,t;return(0,n.jsx)("div",{style:{margin:"6px 0",textAlign:e.from===(null===(r=l.I.currentUser)||void 0===r?void 0:r.uid)?"right":"left"},children:(0,n.jsx)("span",{style:{display:"inline-block",padding:"8px 10px",borderRadius:12,background:e.from===(null===(i=l.I.currentUser)||void 0===i?void 0:i.uid)?"#111":"#f1f5f9",color:e.from===(null===(t=l.I.currentUser)||void 0===t?void 0:t.uid)?"#fff":"#111"},children:e.text})},e.id)})}),(0,n.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,n.jsx)("input",{value:h,onChange:e=>g(e.target.value),placeholder:"Yanıt yaz...",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e5e7eb"}}),(0,n.jsx)("button",{onClick:y,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #111",background:"#111",color:"#fff"},children:"G\xf6nder"})]})]})]})]})}}},function(e){e.O(0,[281,703,771,229,950,888,774,179],function(){return e(e.s=9275)}),_N_E=e.O()}]);