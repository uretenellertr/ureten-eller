(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964,977,876],{7953:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return n(1430)}])},6831:function(e,t,n){"use strict";n.d(t,{I:function(){return s},db:function(){return a}});var r=n(3977),i=n(5876),d=n(9828);let l=(0,r.getApps)().length?(0,r.Mq)():(0,r.initializeApp)({apiKey:"AIzaSyCd9GjP6CDA8i4XByhXDHyESy-g_DHVwvQ",authDomain:"ureteneller-ecaac.firebaseapp.com",projectId:"ureteneller-ecaac",storageBucket:"ureteneller-ecaac.firebasestorage.app",messagingSenderId:"368042877151",appId:"1:368042877151:web:ee0879fc4717928079c96a",measurementId:"G-BJHKN8V4RQ"}),s=(0,i.getAuth)(l),a=(0,d.getFirestore)(l)},1430:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var r=n(5893),i=n(7294),d=n(6831),l=n(5876),s=n(9828);function a(){let[e,t]=i.useState(!1),[n,a]=i.useState(!1),[u,x]=i.useState({orders:"—",pendingListings:"—",openSupport:"—",paymentsPending:"—",usersTotal:"—"}),[f,y]=i.useState([]),[j,g]=i.useState([]),[b,m]=i.useState([]);return(i.useEffect(()=>{let e=(0,l.onAuthStateChanged)(d.I,async e=>{if(!e){a(!1),t(!0);return}try{var n;let t=await (0,s.getDoc)((0,s.doc)(d.db,"users",e.uid)),r=t.exists()?null===(n=t.data())||void 0===n?void 0:n.role:null;a("admin"===r)}catch(e){a(!1)}finally{t(!0)}});return()=>e()},[]),i.useEffect(()=>{if(!e||!n)return;let t=!0;return(async()=>{try{var e,n;let[r,i,l]=await Promise.all([(0,s.getCountFromServer)((0,s.collection)(d.db,"orders")),(0,s.getCountFromServer)((0,s.query)((0,s.collection)(d.db,"listings"),(0,s.where)("status","==","pending"))),(0,s.getCountFromServer)((0,s.query)((0,s.collection)(d.db,"conversations"),(0,s.where)("status","==","open")))]),a="—";try{let t=await (0,s.getCountFromServer)((0,s.collection)(d.db,"users"));a=null!==(e=t.data().count)&&void 0!==e?e:"—"}catch(e){}let c="—";try{let e=await (0,s.getCountFromServer)((0,s.query)((0,s.collection)(d.db,"payments"),(0,s.where)("status","==","pending_admin")));c=null!==(n=e.data().count)&&void 0!==n?n:"—"}catch(e){}if(!t)return;x({orders:r.data().count,pendingListings:i.data().count,openSupport:l.data().count,paymentsPending:c,usersTotal:a})}catch(e){}try{let e=(0,s.query)((0,s.collection)(d.db,"listings"),(0,s.where)("status","==","pending"),(0,s.Xo)("created_at","desc"),(0,s.b9)(5)),t=await (0,s.PL)(e),n=[];t.forEach(e=>n.push({id:e.id,...e.data()})),y(n)}catch(e){}try{let e=(0,s.query)((0,s.collection)(d.db,"conversations"),(0,s.where)("status","==","open"),(0,s.Xo)("updated_at","desc"),(0,s.b9)(5)),t=await (0,s.PL)(e),n=[];t.forEach(e=>n.push({id:e.id,...e.data()})),g(n)}catch(e){}try{let e=(0,s.query)((0,s.collection)(d.db,"orders"),(0,s.Xo)("created_at","desc"),(0,s.b9)(10)),t=await (0,s.PL)(e),n=[];t.forEach(e=>n.push({id:e.id,...e.data()})),m(n)}catch(e){}})(),()=>{t=!1}},[e,n]),e)?(0,r.jsxs)("div",{style:o.page,children:[(0,r.jsxs)("header",{style:o.header,children:[(0,r.jsxs)("div",{style:o.brand,children:["\xdcRETEN ELLER \xb7 ",(0,r.jsx)("b",{children:"Admin"})]}),!n&&(0,r.jsx)("a",{href:"/login?next=/admin/",style:o.badge,children:"Ger\xe7ek veri i\xe7in giriş yap"})]}),(0,r.jsxs)("main",{style:o.main,children:[(0,r.jsxs)("section",{children:[(0,r.jsx)("h1",{style:o.h1,children:"\xd6n Panel"}),(0,r.jsxs)("div",{style:o.grid,children:[(0,r.jsx)(c,{title:"Toplam Sipariş",value:u.orders}),(0,r.jsx)(c,{title:"Onay Bekleyen İlan",value:u.pendingListings}),(0,r.jsx)(c,{title:"A\xe7ık Destek",value:u.openSupport}),(0,r.jsx)(c,{title:"Bekleyen \xd6deme",value:u.paymentsPending}),(0,r.jsx)(c,{title:"Toplam Kullanıcı",value:u.usersTotal})]})]}),(0,r.jsxs)("section",{style:{marginTop:24},children:[(0,r.jsx)("div",{style:o.sectionTitle,children:"Bekleyen İşler"}),(0,r.jsxs)("div",{style:o.twoCols,children:[(0,r.jsxs)("div",{style:o.tableCard,children:[(0,r.jsxs)("div",{style:o.tableHead,children:[(0,r.jsx)("div",{style:o.tableTitle,children:"İlan Onay Kuyruğu"}),(0,r.jsx)("a",{href:"/admin/listings",style:o.link,children:"T\xfcm\xfcn\xfc g\xf6r"})]}),(0,r.jsxs)("table",{style:o.table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Başlık"}),(0,r.jsx)("th",{children:"Satıcı"}),(0,r.jsx)("th",{children:"Fiyat"}),(0,r.jsx)("th",{children:"Oluşturma"}),(0,r.jsx)("th",{children:"İşlem"})]})}),(0,r.jsxs)("tbody",{children:[f.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:e.title||"—"}),(0,r.jsx)("td",{children:e.seller_uid||e.seller_id||"—"}),(0,r.jsx)("td",{children:null!=e.price?h(e.price):"—"}),(0,r.jsx)("td",{children:p(e.created_at)}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:o.stackLeft,children:[(0,r.jsx)("button",{style:o.btnApprove,children:"Onayla"}),(0,r.jsx)("button",{style:o.btnReject,children:"Reddet"})]})})]},e.id)),!f.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,style:o.empty,children:"Kuyruk boş."})})]})]})]}),(0,r.jsxs)("div",{style:o.tableCard,children:[(0,r.jsxs)("div",{style:o.tableHead,children:[(0,r.jsx)("div",{style:o.tableTitle,children:"Destek Talepleri"}),(0,r.jsx)("a",{href:"/admin/support",style:o.link,children:"T\xfcm\xfcn\xfc g\xf6r"})]}),(0,r.jsxs)("table",{style:o.table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Konu"}),(0,r.jsx)("th",{children:"Kullanıcı"}),(0,r.jsx)("th",{children:"Son Mesaj"}),(0,r.jsx)("th",{children:"İşlem"})]})}),(0,r.jsxs)("tbody",{children:[j.map(e=>{var t,n;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:e.subject||"—"}),(0,r.jsx)("td",{children:e.participants&&(null===(t=(n=e.participants).join)||void 0===t?void 0:t.call(n,", "))||"—"}),(0,r.jsx)("td",{children:p(e.updated_at)}),(0,r.jsx)("td",{children:(0,r.jsx)("div",{style:o.stackLeft,children:(0,r.jsx)("a",{href:"/admin/support?id=".concat(e.id),style:o.btnGhost,children:"A\xe7"})})})]},e.id)}),!j.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,style:o.empty,children:"A\xe7ık talep yok."})})]})]})]})]})]}),(0,r.jsxs)("section",{style:{marginTop:24},children:[(0,r.jsx)("div",{style:o.sectionTitle,children:"Son Siparişler"}),(0,r.jsx)("div",{style:o.tableCard,children:(0,r.jsxs)("table",{style:o.table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Alıcı → Satıcı"}),(0,r.jsx)("th",{children:"Tutar"}),(0,r.jsx)("th",{children:"Durum"}),(0,r.jsx)("th",{children:"Tarih"}),(0,r.jsx)("th",{children:"Detay"})]})}),(0,r.jsxs)("tbody",{children:[b.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(e.buyer_uid||"—")+" → "+(e.seller_uid||"—")}),(0,r.jsx)("td",{children:null!=e.amount?h(e.amount):"—"}),(0,r.jsx)("td",{children:e.status||"—"}),(0,r.jsx)("td",{children:p(e.created_at)}),(0,r.jsx)("td",{children:(0,r.jsx)("div",{style:o.stackLeft,children:(0,r.jsx)("a",{href:"/admin/orders?id=".concat(e.id),style:o.btnGhost,children:"G\xf6r"})})})]},e.id)),!b.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,style:o.empty,children:"Kayıt yok."})})]})]})})]})]})]}):null}function c(e){let{title:t,value:n}=e;return(0,r.jsxs)("div",{style:o.card,children:[(0,r.jsx)("div",{style:o.cardTitle,children:t}),(0,r.jsx)("div",{style:o.cardValue,children:n})]})}let o={page:{minHeight:"100vh",background:"#0b0b0b",color:"#e5e7eb",fontFamily:"system-ui,-apple-system,Segoe UI,Roboto,Arial",paddingBottom:24},header:{position:"sticky",top:0,zIndex:10,display:"flex",alignItems:"center",gap:12,padding:"14px 18px",background:"#0b0b0b",borderBottom:"1px solid #1f2937"},brand:{fontWeight:800,letterSpacing:.3},badge:{marginLeft:"auto",fontSize:12,border:"1px solid #374151",padding:"4px 8px",borderRadius:999,color:"#9ca3af",textDecoration:"none"},main:{maxWidth:1200,margin:"0 auto",padding:"20px"},h1:{fontSize:22,fontWeight:800,margin:"0 0 12px"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},card:{background:"#0f0f10",border:"1px solid #1f2937",borderRadius:12,padding:16},cardTitle:{fontSize:13,color:"#94a3b8"},cardValue:{fontSize:28,fontWeight:900},sectionTitle:{fontSize:14,color:"#9ca3af",marginBottom:8},twoCols:{display:"grid",gridTemplateColumns:"1fr",gap:12},tableCard:{background:"#0f0f10",border:"1px solid #1f2937",borderRadius:12,overflow:"hidden"},tableHead:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 14px",borderBottom:"1px solid #1f2937"},tableTitle:{fontWeight:700},link:{color:"#93c5fd",textDecoration:"none"},table:{width:"100%",borderCollapse:"collapse"},empty:{padding:"10px 12px",color:"#9ca3af",textAlign:"center"},stackLeft:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6},btnApprove:{padding:"6px 10px",borderRadius:8,border:"1px solid #065f46",background:"#065f46",color:"#fff",cursor:"pointer"},btnReject:{padding:"6px 10px",borderRadius:8,border:"1px solid #7f1d1d",background:"#7f1d1d",color:"#fff",cursor:"pointer"},btnGhost:{padding:"6px 10px",borderRadius:8,border:"1px solid #374151",background:"transparent",color:"#e5e7eb",textDecoration:"none"}},u=new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",maximumFractionDigits:0});function h(e){try{return u.format(Number(e))}catch(t){return"₺"+String(e)}}function p(e){let t=e?"number"==typeof e?e:"string"==typeof e?Date.parse(e):(null==e?void 0:e.seconds)?1e3*e.seconds+Math.floor((e.nanoseconds||0)/1e6):new Date(e).getTime():null;if(!t)return"—";try{return new Date(t).toLocaleString("tr-TR")}catch(e){return"—"}}},3977:function(e,t,n){"use strict";n.d(t,{Mq:function(){return r.Mq},getApps:function(){return r.C6},initializeApp:function(){return r.ZF}});var r=n(6771);(0,r.KN)("firebase","12.4.0","app")},5876:function(e,t,n){"use strict";n.d(t,{w9:function(){return r.W},hJ:function(){return r.Y},Xb:function(){return r.ab},getAuth:function(){return r.p},onAuthStateChanged:function(){return r.z},aF:function(){return r.a4},w$:function(){return r.ah},LS:function(){return r.a6},signInAnonymously:function(){return r.a1},e5:function(){return r.ac},rh:function(){return r.d},w7:function(){return r.D},gQ:function(){return r.an},ck:function(){return r.al}});var r=n(9199);n(6771),n(9711),n(4645),n(75)}},function(e){e.O(0,[281,703,771,229,888,774,179],function(){return e(e.s=7953)}),_N_E=e.O()}]);